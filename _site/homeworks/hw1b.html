<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistiche descrittive a livello degli item</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../assets/styles.css">
</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#distribuzioni-di-risposte" id="toc-distribuzioni-di-risposte" class="nav-link active" data-scroll-target="#distribuzioni-di-risposte">Distribuzioni di risposte</a></li>
  <li><a href="#statistiche-descrittive" id="toc-statistiche-descrittive" class="nav-link" data-scroll-target="#statistiche-descrittive">Statistiche descrittive</a></li>
  <li><a href="#correlazioni-tra-gli-item" id="toc-correlazioni-tra-gli-item" class="nav-link" data-scroll-target="#correlazioni-tra-gli-item">Correlazioni tra gli item</a></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers">Outliers</a>
  <ul class="collapse">
  <li><a href="#outlier-unidimensionali" id="toc-outlier-unidimensionali" class="nav-link" data-scroll-target="#outlier-unidimensionali">Outlier unidimensionali</a></li>
  <li><a href="#outlier-multidimensionali" id="toc-outlier-multidimensionali" class="nav-link" data-scroll-target="#outlier-multidimensionali">Outlier multidimensionali</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Statistiche descrittive a livello degli item</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>La prima fase della selezione degli item e validazione di un questionario riguarda le statistiche descrittive degli item. Nella prima fase dell’analisi, <span class="citation" data-cites="dima2018scale">Dima (<a href="#ref-dima2018scale" role="doc-biblioref">2018</a>)</span> propone di esaminare gli aspetti seguenti.</p>
<ul>
<li><strong>Frequenze delle risposte e le statistiche degli item.</strong> Le frequenze delle risposte e le statistiche degli item vengono esaminate per valutare se gli item mostrano una sufficiente variazione, in modo da poter differenziare i rispondenti rispetto al/i costrutto/i investigato/i e se ci sono valori fuori range (errori di inserimento dei dati). Le differenze nelle frequenze delle risposte forniscono anche un primo indizio riguardo alla variazione nell’intensità/difficoltà degli item (e aiutano a interpretare eventuali differenze successive tra i risultati di IRT e FA).</li>
<li><strong>Associazioni tra gli item.</strong> Le associazioni tra gli item vengono esaminate per identificare eventuali correlazioni negative (e codificare tali item al contrario per le analisi successive).</li>
<li><strong>Outlier.</strong> L’individuazione degli outlier multivariati aiuta a identificare eventuali rispondenti con pattern di risposta idiosincratici, che possono essere ulteriormente investigati ed eventualmente esclusi (ad esempio, se vengono identificati errori nella raccolta/inserimento dei dati) o mantenuti nel campione (se non ci sono validi motivi per l’esclusione). Oppure possiamo rimuovere i valori anomali e procedure con l’imputazione multipla dei dati mancanti.</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"cleaned_data.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(rio)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MASS)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(corrplot)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(outliers)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(performance)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(see)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(isotree)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Seleziono gli item della sottoscala “Problemi comportamentali” dell’Area 1 “Caratterisriche del bambino”.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>item_codes <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"aree_tematiche_items.csv"</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>behav_problems_item_names <span class="ot">&lt;-</span> item_codes[<span class="dv">6</span><span class="sc">:</span><span class="dv">16</span>, ]<span class="sc">$</span>Item_Code</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>behav_problems_item_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "i86"  "i152" "i1"   "i47"  "i121" "i57"  "i167" "i91"  "i99"  "i135"
[11] "i63" </code></pre>
</div>
</div>
<p>L’item FAI_152 è stato eliminato in precedenza.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FAI_86"</span>, <span class="st">"FAI_1"</span>, <span class="st">"FAI_47"</span>, <span class="st">"FAI_121"</span>, <span class="st">"FAI_57"</span>, <span class="st">"FAI_167"</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FAI_91"</span>, <span class="st">"FAI_99"</span>, <span class="st">"FAI_135"</span>, <span class="st">"FAI_163"</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(selected_columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="distribuzioni-di-risposte" class="level2">
<h2 class="anchored" data-anchor-id="distribuzioni-di-risposte">Distribuzioni di risposte</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>myitems <span class="ot">&lt;-</span> <span class="fu">names</span>(mydata)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( n <span class="cf">in</span> myitems)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>( <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, n, <span class="st">":"</span> );</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">table</span>( mydata[,n], <span class="at">exclude=</span><span class="cn">NULL</span> ) );</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 FAI_86 :
  0   1   2   3   4 
112 211  81  30  19 

 FAI_1 :
  0   1   2   3   4 
303 107  33   7   3 

 FAI_47 :
  0   1   2   3   4 
 82 129 141  79  22 

 FAI_121 :
  0   1   2   3   4 
272 154  16   8   3 

 FAI_57 :
  0   1   2   3   4 
323  98  22   7   3 

 FAI_167 :
  0   1   2   3   4 
 37 114 194  70  38 

 FAI_91 :
  0   1   2   3   4 
298 109  19  14  13 

 FAI_99 :
  0   1   2   3   4 
 25 134 161  54  79 

 FAI_135 :
  0   1   2   3   4 
327  85  31   4   6 

 FAI_163 :
  0   1   2   3   4 
 72 160 163  46  12 </code></pre>
</div>
</div>
<p>Verificare se le variabili sono codificate come numeriche.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mydata[, <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># File to write the summaries</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>summaries.file <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"summaries.txt"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to write summary for a variable</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>write.summary.var <span class="ot">&lt;-</span> <span class="cf">function</span>(x, xname) {</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    a1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    a2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    a3 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    a4 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">3</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    a5 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">4</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    total_non_na <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x))  <span class="co"># Total non-NA values</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    a6 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">sum</span>(x <span class="sc">&lt;=</span> <span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> total_non_na), <span class="dv">2</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    a7 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">sum</span>(x <span class="sc">&gt;</span> <span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> total_non_na), <span class="dv">2</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    a8 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(x))</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(xname, a1, a2, a3, a4, a5, a6, a7, a8, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">file =</span> summaries.file, <span class="at">append =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. For each item, run this function iteratively</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> myitems) {</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.summary.var</span>(mydata[, n], n)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the table in R</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>myitemssum <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"summaries.txt"</span>), <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="st">"</span><span class="sc">\"</span><span class="st">"</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Add column names</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(myitemssum) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Item label"</span>, <span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"% 0 to 2"</span>, </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"% 2 to 4"</span>, <span class="st">"No. missing"</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the result</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(myitemssum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Item label   0   1   2  3  4 % 0 to 2 % 2 to 4 No. missing
1       FAI_86 112 211  81 30 19    89.18    10.82           0
2        FAI_1 303 107  33  7  3    97.79     2.21           0
3       FAI_47  82 129 141 79 22    77.70    22.30           0
4      FAI_121 272 154  16  8  3    97.57     2.43           0
5       FAI_57 323  98  22  7  3    97.79     2.21           0
6      FAI_167  37 114 194 70 38    76.16    23.84           0
7       FAI_91 298 109  19 14 13    94.04     5.96           0
8       FAI_99  25 134 161 54 79    70.64    29.36           0
9      FAI_135 327  85  31  4  6    97.79     2.21           0
10     FAI_163  72 160 163 46 12    87.20    12.80           0
11      FAI_86 112 211  81 30 19    89.18    10.82           0
12       FAI_1 303 107  33  7  3    97.79     2.21           0
13      FAI_47  82 129 141 79 22    77.70    22.30           0
14     FAI_121 272 154  16  8  3    97.57     2.43           0
15      FAI_57 323  98  22  7  3    97.79     2.21           0
16     FAI_167  37 114 194 70 38    76.16    23.84           0
17      FAI_91 298 109  19 14 13    94.04     5.96           0
18      FAI_99  25 134 161 54 79    70.64    29.36           0
19     FAI_135 327  85  31  4  6    97.79     2.21           0
20     FAI_163  72 160 163 46 12    87.20    12.80           0
21      FAI_86 112 211  81 30 19    89.18    10.82           0
22       FAI_1 303 107  33  7  3    97.79     2.21           0
23      FAI_47  82 129 141 79 22    77.70    22.30           0
24     FAI_121 272 154  16  8  3    97.57     2.43           0
25      FAI_57 323  98  22  7  3    97.79     2.21           0
26     FAI_167  37 114 194 70 38    76.16    23.84           0
27      FAI_91 298 109  19 14 13    94.04     5.96           0
28      FAI_99  25 134 161 54 79    70.64    29.36           0
29     FAI_135 327  85  31  4  6    97.79     2.21           0
30     FAI_163  72 160 163 46 12    87.20    12.80           0
31      FAI_86 112 211  81 30 19    89.18    10.82           0
32       FAI_1 303 107  33  7  3    97.79     2.21           0
33      FAI_47  82 129 141 79 22    77.70    22.30           0
34     FAI_121 272 154  16  8  3    97.57     2.43           0
35      FAI_57 323  98  22  7  3    97.79     2.21           0
36     FAI_167  37 114 194 70 38    76.16    23.84           0
37      FAI_91 298 109  19 14 13    94.04     5.96           0
38      FAI_99  25 134 161 54 79    70.64    29.36           0
39     FAI_135 327  85  31  4  6    97.79     2.21           0
40     FAI_163  72 160 163 46 12    87.20    12.80           0
41      FAI_86 112 211  81 30 19    89.18    10.82           0
42       FAI_1 303 107  33  7  3    97.79     2.21           0
43      FAI_47  82 129 141 79 22    77.70    22.30           0
44     FAI_121 272 154  16  8  3    97.57     2.43           0
45      FAI_57 323  98  22  7  3    97.79     2.21           0
46     FAI_167  37 114 194 70 38    76.16    23.84           0
47      FAI_91 298 109  19 14 13    94.04     5.96           0
48      FAI_99  25 134 161 54 79    70.64    29.36           0
49     FAI_135 327  85  31  4  6    97.79     2.21           0
50     FAI_163  72 160 163 46 12    87.20    12.80           0
51      FAI_86 112 211  81 30 19    89.18    10.82           0
52       FAI_1 303 107  33  7  3    97.79     2.21           0
53      FAI_47  82 129 141 79 22    77.70    22.30           0
54     FAI_121 272 154  16  8  3    97.57     2.43           0
55      FAI_57 323  98  22  7  3    97.79     2.21           0
56     FAI_167  37 114 194 70 38    76.16    23.84           0
57      FAI_91 298 109  19 14 13    94.04     5.96           0
58      FAI_99  25 134 161 54 79    70.64    29.36           0
59     FAI_135 327  85  31  4  6    97.79     2.21           0
60     FAI_163  72 160 163 46 12    87.20    12.80           0
61      FAI_86 112 211  81 30 19    89.18    10.82           0
62       FAI_1 303 107  33  7  3    97.79     2.21           0
63      FAI_47  82 129 141 79 22    77.70    22.30           0
64     FAI_121 272 154  16  8  3    97.57     2.43           0
65      FAI_57 323  98  22  7  3    97.79     2.21           0
66     FAI_167  37 114 194 70 38    76.16    23.84           0
67      FAI_91 298 109  19 14 13    94.04     5.96           0
68      FAI_99  25 134 161 54 79    70.64    29.36           0
69     FAI_135 327  85  31  4  6    97.79     2.21           0
70     FAI_163  72 160 163 46 12    87.20    12.80           0
71      FAI_86 112 211  81 30 19    89.18    10.82           0
72       FAI_1 303 107  33  7  3    97.79     2.21           0
73      FAI_47  82 129 141 79 22    77.70    22.30           0
74     FAI_121 272 154  16  8  3    97.57     2.43           0
75      FAI_57 323  98  22  7  3    97.79     2.21           0
76     FAI_167  37 114 194 70 38    76.16    23.84           0
77      FAI_91 298 109  19 14 13    94.04     5.96           0
78      FAI_99  25 134 161 54 79    70.64    29.36           0
79     FAI_135 327  85  31  4  6    97.79     2.21           0
80     FAI_163  72 160 163 46 12    87.20    12.80           0
81      FAI_86 112 211  81 30 19    89.18    10.82           0
82       FAI_1 303 107  33  7  3    97.79     2.21           0
83      FAI_47  82 129 141 79 22    77.70    22.30           0
84     FAI_121 272 154  16  8  3    97.57     2.43           0
85      FAI_57 323  98  22  7  3    97.79     2.21           0
86     FAI_167  37 114 194 70 38    76.16    23.84           0
87      FAI_91 298 109  19 14 13    94.04     5.96           0
88      FAI_99  25 134 161 54 79    70.64    29.36           0
89     FAI_135 327  85  31  4  6    97.79     2.21           0
90     FAI_163  72 160 163 46 12    87.20    12.80           0
91      FAI_86 112 211  81 30 19    89.18    10.82           0
92       FAI_1 303 107  33  7  3    97.79     2.21           0
93      FAI_47  82 129 141 79 22    77.70    22.30           0
94     FAI_121 272 154  16  8  3    97.57     2.43           0
95      FAI_57 323  98  22  7  3    97.79     2.21           0
96     FAI_167  37 114 194 70 38    76.16    23.84           0
97      FAI_91 298 109  19 14 13    94.04     5.96           0
98      FAI_99  25 134 161 54 79    70.64    29.36           0
99     FAI_135 327  85  31  4  6    97.79     2.21           0
100    FAI_163  72 160 163 46 12    87.20    12.80           0
101     FAI_86 112 211  81 30 19    89.18    10.82           0
102      FAI_1 303 107  33  7  3    97.79     2.21           0
103     FAI_47  82 129 141 79 22    77.70    22.30           0
104    FAI_121 272 154  16  8  3    97.57     2.43           0
105     FAI_57 323  98  22  7  3    97.79     2.21           0
106    FAI_167  37 114 194 70 38    76.16    23.84           0
107     FAI_91 298 109  19 14 13    94.04     5.96           0
108     FAI_99  25 134 161 54 79    70.64    29.36           0
109    FAI_135 327  85  31  4  6    97.79     2.21           0
110    FAI_163  72 160 163 46 12    87.20    12.80           0
111     FAI_86 112 211  81 30 19    89.18    10.82           0
112      FAI_1 303 107  33  7  3    97.79     2.21           0
113     FAI_47  82 129 141 79 22    77.70    22.30           0
114    FAI_121 272 154  16  8  3    97.57     2.43           0
115     FAI_57 323  98  22  7  3    97.79     2.21           0
116    FAI_167  37 114 194 70 38    76.16    23.84           0
117     FAI_91 298 109  19 14 13    94.04     5.96           0
118     FAI_99  25 134 161 54 79    70.64    29.36           0
119    FAI_135 327  85  31  4  6    97.79     2.21           0
120    FAI_163  72 160 163 46 12    87.20    12.80           0
121     FAI_86 112 211  81 30 19    89.18    10.82           0
122      FAI_1 303 107  33  7  3    97.79     2.21           0
123     FAI_47  82 129 141 79 22    77.70    22.30           0
124    FAI_121 272 154  16  8  3    97.57     2.43           0
125     FAI_57 323  98  22  7  3    97.79     2.21           0
126    FAI_167  37 114 194 70 38    76.16    23.84           0
127     FAI_91 298 109  19 14 13    94.04     5.96           0
128     FAI_99  25 134 161 54 79    70.64    29.36           0
129    FAI_135 327  85  31  4  6    97.79     2.21           0
130    FAI_163  72 160 163 46 12    87.20    12.80           0
131     FAI_86 112 211  81 30 19    89.18    10.82           0
132      FAI_1 303 107  33  7  3    97.79     2.21           0
133     FAI_47  82 129 141 79 22    77.70    22.30           0
134    FAI_121 272 154  16  8  3    97.57     2.43           0
135     FAI_57 323  98  22  7  3    97.79     2.21           0
136    FAI_167  37 114 194 70 38    76.16    23.84           0
137     FAI_91 298 109  19 14 13    94.04     5.96           0
138     FAI_99  25 134 161 54 79    70.64    29.36           0
139    FAI_135 327  85  31  4  6    97.79     2.21           0
140    FAI_163  72 160 163 46 12    87.20    12.80           0
141     FAI_86 112 211  81 30 19    89.18    10.82           0
142      FAI_1 303 107  33  7  3    97.79     2.21           0
143     FAI_47  82 129 141 79 22    77.70    22.30           0
144    FAI_121 272 154  16  8  3    97.57     2.43           0
145     FAI_57 323  98  22  7  3    97.79     2.21           0
146    FAI_167  37 114 194 70 38    76.16    23.84           0
147     FAI_91 298 109  19 14 13    94.04     5.96           0
148     FAI_99  25 134 161 54 79    70.64    29.36           0
149    FAI_135 327  85  31  4  6    97.79     2.21           0
150    FAI_163  72 160 163 46 12    87.20    12.80           0
151     FAI_86 112 211  81 30 19    89.18    10.82           0
152      FAI_1 303 107  33  7  3    97.79     2.21           0
153     FAI_47  82 129 141 79 22    77.70    22.30           0
154    FAI_121 272 154  16  8  3    97.57     2.43           0
155     FAI_57 323  98  22  7  3    97.79     2.21           0
156    FAI_167  37 114 194 70 38    76.16    23.84           0
157     FAI_91 298 109  19 14 13    94.04     5.96           0
158     FAI_99  25 134 161 54 79    70.64    29.36           0
159    FAI_135 327  85  31  4  6    97.79     2.21           0
160    FAI_163  72 160 163 46 12    87.20    12.80           0
161     FAI_86 112 211  81 30 19    89.18    10.82           0
162      FAI_1 303 107  33  7  3    97.79     2.21           0
163     FAI_47  82 129 141 79 22    77.70    22.30           0
164    FAI_121 272 154  16  8  3    97.57     2.43           0
165     FAI_57 323  98  22  7  3    97.79     2.21           0
166    FAI_167  37 114 194 70 38    76.16    23.84           0
167     FAI_91 298 109  19 14 13    94.04     5.96           0
168     FAI_99  25 134 161 54 79    70.64    29.36           0
169    FAI_135 327  85  31  4  6    97.79     2.21           0
170    FAI_163  72 160 163 46 12    87.20    12.80           0
171     FAI_86 112 211  81 30 19    89.18    10.82           0
172      FAI_1 303 107  33  7  3    97.79     2.21           0
173     FAI_47  82 129 141 79 22    77.70    22.30           0
174    FAI_121 272 154  16  8  3    97.57     2.43           0
175     FAI_57 323  98  22  7  3    97.79     2.21           0
176    FAI_167  37 114 194 70 38    76.16    23.84           0
177     FAI_91 298 109  19 14 13    94.04     5.96           0
178     FAI_99  25 134 161 54 79    70.64    29.36           0
179    FAI_135 327  85  31  4  6    97.79     2.21           0
180    FAI_163  72 160 163 46 12    87.20    12.80           0
181     FAI_86 112 211  81 30 19    89.18    10.82           0
182      FAI_1 303 107  33  7  3    97.79     2.21           0
183     FAI_47  82 129 141 79 22    77.70    22.30           0
184    FAI_121 272 154  16  8  3    97.57     2.43           0
185     FAI_57 323  98  22  7  3    97.79     2.21           0
186    FAI_167  37 114 194 70 38    76.16    23.84           0
187     FAI_91 298 109  19 14 13    94.04     5.96           0
188     FAI_99  25 134 161 54 79    70.64    29.36           0
189    FAI_135 327  85  31  4  6    97.79     2.21           0
190    FAI_163  72 160 163 46 12    87.20    12.80           0
191     FAI_86 112 211  81 30 19    89.18    10.82           0
192      FAI_1 303 107  33  7  3    97.79     2.21           0
193     FAI_47  82 129 141 79 22    77.70    22.30           0
194    FAI_121 272 154  16  8  3    97.57     2.43           0
195     FAI_57 323  98  22  7  3    97.79     2.21           0
196    FAI_167  37 114 194 70 38    76.16    23.84           0
197     FAI_91 298 109  19 14 13    94.04     5.96           0
198     FAI_99  25 134 161 54 79    70.64    29.36           0
199    FAI_135 327  85  31  4  6    97.79     2.21           0
200    FAI_163  72 160 163 46 12    87.20    12.80           0
201     FAI_86 112 211  81 30 19    89.18    10.82           0
202      FAI_1 303 107  33  7  3    97.79     2.21           0
203     FAI_47  82 129 141 79 22    77.70    22.30           0
204    FAI_121 272 154  16  8  3    97.57     2.43           0
205     FAI_57 323  98  22  7  3    97.79     2.21           0
206    FAI_167  37 114 194 70 38    76.16    23.84           0
207     FAI_91 298 109  19 14 13    94.04     5.96           0
208     FAI_99  25 134 161 54 79    70.64    29.36           0
209    FAI_135 327  85  31  4  6    97.79     2.21           0
210    FAI_163  72 160 163 46 12    87.20    12.80           0
211     FAI_86 112 211  81 30 19    89.18    10.82           0
212      FAI_1 303 107  33  7  3    97.79     2.21           0
213     FAI_47  82 129 141 79 22    77.70    22.30           0
214    FAI_121 272 154  16  8  3    97.57     2.43           0
215     FAI_57 323  98  22  7  3    97.79     2.21           0
216    FAI_167  37 114 194 70 38    76.16    23.84           0
217     FAI_91 298 109  19 14 13    94.04     5.96           0
218     FAI_99  25 134 161 54 79    70.64    29.36           0
219    FAI_135 327  85  31  4  6    97.79     2.21           0
220    FAI_163  72 160 163 46 12    87.20    12.80           0
221     FAI_86 112 211  81 30 19    89.18    10.82           0
222      FAI_1 303 107  33  7  3    97.79     2.21           0
223     FAI_47  82 129 141 79 22    77.70    22.30           0
224    FAI_121 272 154  16  8  3    97.57     2.43           0
225     FAI_57 323  98  22  7  3    97.79     2.21           0
226    FAI_167  37 114 194 70 38    76.16    23.84           0
227     FAI_91 298 109  19 14 13    94.04     5.96           0
228     FAI_99  25 134 161 54 79    70.64    29.36           0
229    FAI_135 327  85  31  4  6    97.79     2.21           0
230    FAI_163  72 160 163 46 12    87.20    12.80           0
231     FAI_86 112 211  81 30 19    89.18    10.82           0
232      FAI_1 303 107  33  7  3    97.79     2.21           0
233     FAI_47  82 129 141 79 22    77.70    22.30           0
234    FAI_121 272 154  16  8  3    97.57     2.43           0
235     FAI_57 323  98  22  7  3    97.79     2.21           0
236    FAI_167  37 114 194 70 38    76.16    23.84           0
237     FAI_91 298 109  19 14 13    94.04     5.96           0
238     FAI_99  25 134 161 54 79    70.64    29.36           0
239    FAI_135 327  85  31  4  6    97.79     2.21           0
240    FAI_163  72 160 163 46 12    87.20    12.80           0
241     FAI_86 112 211  81 30 19    89.18    10.82           0
242      FAI_1 303 107  33  7  3    97.79     2.21           0
243     FAI_47  82 129 141 79 22    77.70    22.30           0
244    FAI_121 272 154  16  8  3    97.57     2.43           0
245     FAI_57 323  98  22  7  3    97.79     2.21           0
246    FAI_167  37 114 194 70 38    76.16    23.84           0
247     FAI_91 298 109  19 14 13    94.04     5.96           0
248     FAI_99  25 134 161 54 79    70.64    29.36           0
249    FAI_135 327  85  31  4  6    97.79     2.21           0
250    FAI_163  72 160 163 46 12    87.20    12.80           0</code></pre>
</div>
</div>
</section>
<section id="statistiche-descrittive" class="level2">
<h2 class="anchored" data-anchor-id="statistiche-descrittive">Statistiche descrittive</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>descrmyitems <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>( <span class="fu">round</span>( psych<span class="sc">::</span><span class="fu">describe</span>( mydata ), <span class="dv">2</span> ))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>descrmyitems</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        vars   n mean   sd median trimmed  mad min max range skew kurtosis   se
FAI_86     1 453 1.19 1.02      1    1.06 1.48   0   4     4 0.95     0.64 0.05
FAI_1      2 453 0.45 0.75      0    0.29 0.00   0   4     4 1.86     3.72 0.04
FAI_47     3 453 1.62 1.11      2    1.60 1.48   0   4     4 0.20    -0.73 0.05
FAI_121    4 453 0.49 0.71      0    0.37 0.00   0   4     4 1.83     4.57 0.03
FAI_57     5 453 0.39 0.71      0    0.23 0.00   0   4     4 2.22     5.64 0.03
FAI_167    6 453 1.91 1.03      2    1.88 1.48   0   4     4 0.20    -0.27 0.05
FAI_91     7 453 0.53 0.93      0    0.31 0.00   0   4     4 2.14     4.43 0.04
FAI_99     8 453 2.06 1.15      2    2.02 1.48   0   4     4 0.34    -0.79 0.05
FAI_135    9 453 0.40 0.77      0    0.22 0.00   0   4     4 2.29     5.89 0.04
FAI_163   10 453 1.48 0.97      1    1.45 1.48   0   4     4 0.30    -0.22 0.05</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># order items based on percentage based on the 8th column (% high scores)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>myitemssumOrder <span class="ot">&lt;-</span> myitemssum[<span class="fu">order</span>(myitemssum[, <span class="dv">8</span>]),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(myitemssumOrder[,<span class="st">"% 2 to 4"</span>], </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"High score frequencies for items"</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Items"</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Number of respondents"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.lab=</span><span class="fl">0.8</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.axis=</span><span class="fl">0.8</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg=</span>myitemssumOrder[, <span class="st">"Item label"</span>], </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">las=</span><span class="dv">2</span>, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.names=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw1b_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>( <span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)) <span class="co"># set several plots per rows and columns</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( n <span class="cf">in</span> myitems)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  distr <span class="ot">&lt;-</span> <span class="fu">table</span>(mydata[,n])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">barplot</span>(distr,  </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span>n, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="fu">gray.colors</span>(<span class="dv">20</span>), </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Number of respondents"</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Response (0=Negative, 4=Positive)"</span>);</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw1b_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="correlazioni-tra-gli-item" class="level2">
<h2 class="anchored" data-anchor-id="correlazioni-tra-gli-item">Correlazioni tra gli item</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for ordinal items use Spearman correlations</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>bluesqs <span class="ot">&lt;-</span> <span class="fu">cor</span>(mydata, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(bluesqs, <span class="at">method =</span> <span class="st">"number"</span>, <span class="at">main =</span> <span class="st">"Correlations Between Items"</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">number.cex =</span> <span class="fl">0.5</span>, <span class="at">tl.cex =</span> <span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw1b_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="outliers" class="level2">
<h2 class="anchored" data-anchor-id="outliers">Outliers</h2>
<p>Per l’esame degli outlier useremo le funzionalità del pacchetto <a href="https://easystats.github.io/performance/articles/check_outliers.html"><code>performance</code></a><span class="citation" data-cites="theriault2024check">(<a href="#ref-theriault2024check" role="doc-biblioref">Thériault et al. 2024</a>)</span>.</p>
<section id="outlier-unidimensionali" class="level3">
<h3 class="anchored" data-anchor-id="outlier-unidimensionali">Outlier unidimensionali</h3>
<p>Aggiungo la colonna <code>id</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mydata) <span class="sc">|&gt;</span> <span class="fu">as.factor</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> mydata <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, FAI_86)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">check_outliers</span>(foo, <span class="at">method =</span> <span class="st">"zscore_robust"</span>, <span class="at">ID =</span> <span class="st">"id"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>outliers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OK: No outliers detected.
- Based on the following method and threshold: zscore_robust (3.291).
- For variable: FAI_86</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> mydata <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, FAI_1)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">check_outliers</span>(foo, <span class="at">method =</span> <span class="st">"zscore_robust"</span>, <span class="at">ID =</span> <span class="st">"id"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>outliers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>150 outliers detected: cases 2, 5, 8, 11, 12, 29, 36, 37, 40, 41, 42,
  47, 49, 51, 52, 53, 54, 62, 63, 72, 73, 78, 79, 84, 88, 89, 94, 109,
  111, 113, 116, 117, 123, 127, 131, 137, 148, 151, 152, 154, 160, 165,
  166, 168, 172, 173, 180, 181, 182, 184, 187, 189, 190, 193, 194, 195,
  196, 198, 199, 201, 202, 204, 213, 214, 216, 217, 218, 226, 227, 229,
  230, 231, 232, 241, 243, 248, 250, 251, 254, 255, 256, 257, 258, 259,
  261, 263, 264, 265, 266, 267, 271, 274, 277, 278, 283, 288, 291, 292,
  296, 302, 303, 304, 313, 314, 315, 316, 317, 325, 327, 329, 330, 331,
  332, 334, 336, 339, 341, 342, 346, 348, 351, 352, 353, 356, 359, 360,
  369, 370, 372, 374, 379, 383, 387, 393, 397, 398, 399, 405, 411, 417,
  418, 419, 425, 426, 432, 433, 444, 445, 448, 449.
- Based on the following method and threshold: zscore_robust (3.291).
- For variable: FAI_1.

-----------------------------------------------------------------------------
Outliers per variable (zscore_robust): 

$FAI_1
       Row   id Distance_Zscore_robust
NA      NA &lt;NA&gt;                     NA
2        2    2                    Inf
NA.1    NA &lt;NA&gt;                     NA
NA.2    NA &lt;NA&gt;                     NA
5        5    5                    Inf
NA.3    NA &lt;NA&gt;                     NA
NA.4    NA &lt;NA&gt;                     NA
8        8    8                    Inf
NA.5    NA &lt;NA&gt;                     NA
NA.6    NA &lt;NA&gt;                     NA
11      11   11                    Inf
12      12   12                    Inf
NA.7    NA &lt;NA&gt;                     NA
NA.8    NA &lt;NA&gt;                     NA
NA.9    NA &lt;NA&gt;                     NA
NA.10   NA &lt;NA&gt;                     NA
NA.11   NA &lt;NA&gt;                     NA
NA.12   NA &lt;NA&gt;                     NA
NA.13   NA &lt;NA&gt;                     NA
NA.14   NA &lt;NA&gt;                     NA
NA.15   NA &lt;NA&gt;                     NA
NA.16   NA &lt;NA&gt;                     NA
NA.17   NA &lt;NA&gt;                     NA
NA.18   NA &lt;NA&gt;                     NA
NA.19   NA &lt;NA&gt;                     NA
NA.20   NA &lt;NA&gt;                     NA
NA.21   NA &lt;NA&gt;                     NA
NA.22   NA &lt;NA&gt;                     NA
29      29   29                    Inf
NA.23   NA &lt;NA&gt;                     NA
NA.24   NA &lt;NA&gt;                     NA
NA.25   NA &lt;NA&gt;                     NA
NA.26   NA &lt;NA&gt;                     NA
NA.27   NA &lt;NA&gt;                     NA
NA.28   NA &lt;NA&gt;                     NA
36      36   36                    Inf
37      37   37                    Inf
NA.29   NA &lt;NA&gt;                     NA
NA.30   NA &lt;NA&gt;                     NA
40      40   40                    Inf
41      41   41                    Inf
42      42   42                    Inf
NA.31   NA &lt;NA&gt;                     NA
NA.32   NA &lt;NA&gt;                     NA
NA.33   NA &lt;NA&gt;                     NA
NA.34   NA &lt;NA&gt;                     NA
47      47   47                    Inf
NA.35   NA &lt;NA&gt;                     NA
49      49   49                    Inf
NA.36   NA &lt;NA&gt;                     NA
51      51   51                    Inf
52      52   52                    Inf
53      53   53                    Inf
54      54   54                    Inf
NA.37   NA &lt;NA&gt;                     NA
NA.38   NA &lt;NA&gt;                     NA
NA.39   NA &lt;NA&gt;                     NA
NA.40   NA &lt;NA&gt;                     NA
NA.41   NA &lt;NA&gt;                     NA
NA.42   NA &lt;NA&gt;                     NA
NA.43   NA &lt;NA&gt;                     NA
62      62   62                    Inf
63      63   63                    Inf
NA.44   NA &lt;NA&gt;                     NA
NA.45   NA &lt;NA&gt;                     NA
NA.46   NA &lt;NA&gt;                     NA
NA.47   NA &lt;NA&gt;                     NA
NA.48   NA &lt;NA&gt;                     NA
NA.49   NA &lt;NA&gt;                     NA
NA.50   NA &lt;NA&gt;                     NA
NA.51   NA &lt;NA&gt;                     NA
72      72   72                    Inf
73      73   73                    Inf
NA.52   NA &lt;NA&gt;                     NA
NA.53   NA &lt;NA&gt;                     NA
NA.54   NA &lt;NA&gt;                     NA
NA.55   NA &lt;NA&gt;                     NA
78      78   78                    Inf
79      79   79                    Inf
NA.56   NA &lt;NA&gt;                     NA
NA.57   NA &lt;NA&gt;                     NA
NA.58   NA &lt;NA&gt;                     NA
NA.59   NA &lt;NA&gt;                     NA
84      84   84                    Inf
NA.60   NA &lt;NA&gt;                     NA
NA.61   NA &lt;NA&gt;                     NA
NA.62   NA &lt;NA&gt;                     NA
88      88   88                    Inf
89      89   89                    Inf
NA.63   NA &lt;NA&gt;                     NA
NA.64   NA &lt;NA&gt;                     NA
NA.65   NA &lt;NA&gt;                     NA
NA.66   NA &lt;NA&gt;                     NA
94      94   94                    Inf
NA.67   NA &lt;NA&gt;                     NA
NA.68   NA &lt;NA&gt;                     NA
NA.69   NA &lt;NA&gt;                     NA
NA.70   NA &lt;NA&gt;                     NA
NA.71   NA &lt;NA&gt;                     NA
NA.72   NA &lt;NA&gt;                     NA
NA.73   NA &lt;NA&gt;                     NA
NA.74   NA &lt;NA&gt;                     NA
NA.75   NA &lt;NA&gt;                     NA
NA.76   NA &lt;NA&gt;                     NA
NA.77   NA &lt;NA&gt;                     NA
NA.78   NA &lt;NA&gt;                     NA
NA.79   NA &lt;NA&gt;                     NA
NA.80   NA &lt;NA&gt;                     NA
109    109  109                    Inf
NA.81   NA &lt;NA&gt;                     NA
111    111  111                    Inf
NA.82   NA &lt;NA&gt;                     NA
113    113  113                    Inf
NA.83   NA &lt;NA&gt;                     NA
NA.84   NA &lt;NA&gt;                     NA
116    116  116                    Inf
117    117  117                    Inf
NA.85   NA &lt;NA&gt;                     NA
NA.86   NA &lt;NA&gt;                     NA
NA.87   NA &lt;NA&gt;                     NA
NA.88   NA &lt;NA&gt;                     NA
NA.89   NA &lt;NA&gt;                     NA
123    123  123                    Inf
NA.90   NA &lt;NA&gt;                     NA
NA.91   NA &lt;NA&gt;                     NA
NA.92   NA &lt;NA&gt;                     NA
127    127  127                    Inf
NA.93   NA &lt;NA&gt;                     NA
NA.94   NA &lt;NA&gt;                     NA
NA.95   NA &lt;NA&gt;                     NA
131    131  131                    Inf
NA.96   NA &lt;NA&gt;                     NA
NA.97   NA &lt;NA&gt;                     NA
NA.98   NA &lt;NA&gt;                     NA
NA.99   NA &lt;NA&gt;                     NA
NA.100  NA &lt;NA&gt;                     NA
137    137  137                    Inf
NA.101  NA &lt;NA&gt;                     NA
NA.102  NA &lt;NA&gt;                     NA
NA.103  NA &lt;NA&gt;                     NA
NA.104  NA &lt;NA&gt;                     NA
NA.105  NA &lt;NA&gt;                     NA
NA.106  NA &lt;NA&gt;                     NA
NA.107  NA &lt;NA&gt;                     NA
NA.108  NA &lt;NA&gt;                     NA
NA.109  NA &lt;NA&gt;                     NA
NA.110  NA &lt;NA&gt;                     NA
148    148  148                    Inf
NA.111  NA &lt;NA&gt;                     NA
NA.112  NA &lt;NA&gt;                     NA
151    151  151                    Inf
152    152  152                    Inf
NA.113  NA &lt;NA&gt;                     NA
154    154  154                    Inf
NA.114  NA &lt;NA&gt;                     NA
NA.115  NA &lt;NA&gt;                     NA
NA.116  NA &lt;NA&gt;                     NA
NA.117  NA &lt;NA&gt;                     NA
NA.118  NA &lt;NA&gt;                     NA
160    160  160                    Inf
NA.119  NA &lt;NA&gt;                     NA
NA.120  NA &lt;NA&gt;                     NA
NA.121  NA &lt;NA&gt;                     NA
NA.122  NA &lt;NA&gt;                     NA
165    165  165                    Inf
166    166  166                    Inf
NA.123  NA &lt;NA&gt;                     NA
168    168  168                    Inf
NA.124  NA &lt;NA&gt;                     NA
NA.125  NA &lt;NA&gt;                     NA
NA.126  NA &lt;NA&gt;                     NA
172    172  172                    Inf
173    173  173                    Inf
NA.127  NA &lt;NA&gt;                     NA
NA.128  NA &lt;NA&gt;                     NA
NA.129  NA &lt;NA&gt;                     NA
NA.130  NA &lt;NA&gt;                     NA
NA.131  NA &lt;NA&gt;                     NA
NA.132  NA &lt;NA&gt;                     NA
180    180  180                    Inf
181    181  181                    Inf
182    182  182                    Inf
NA.133  NA &lt;NA&gt;                     NA
184    184  184                    Inf
NA.134  NA &lt;NA&gt;                     NA
NA.135  NA &lt;NA&gt;                     NA
187    187  187                    Inf
NA.136  NA &lt;NA&gt;                     NA
189    189  189                    Inf
190    190  190                    Inf
NA.137  NA &lt;NA&gt;                     NA
NA.138  NA &lt;NA&gt;                     NA
193    193  193                    Inf
194    194  194                    Inf
195    195  195                    Inf
196    196  196                    Inf
NA.139  NA &lt;NA&gt;                     NA
198    198  198                    Inf
199    199  199                    Inf
NA.140  NA &lt;NA&gt;                     NA
201    201  201                    Inf
202    202  202                    Inf
NA.141  NA &lt;NA&gt;                     NA
204    204  204                    Inf
NA.142  NA &lt;NA&gt;                     NA
NA.143  NA &lt;NA&gt;                     NA
NA.144  NA &lt;NA&gt;                     NA
NA.145  NA &lt;NA&gt;                     NA
NA.146  NA &lt;NA&gt;                     NA
NA.147  NA &lt;NA&gt;                     NA
NA.148  NA &lt;NA&gt;                     NA
NA.149  NA &lt;NA&gt;                     NA
213    213  213                    Inf
214    214  214                    Inf
NA.150  NA &lt;NA&gt;                     NA
216    216  216                    Inf
217    217  217                    Inf
218    218  218                    Inf
NA.151  NA &lt;NA&gt;                     NA
NA.152  NA &lt;NA&gt;                     NA
NA.153  NA &lt;NA&gt;                     NA
NA.154  NA &lt;NA&gt;                     NA
NA.155  NA &lt;NA&gt;                     NA
NA.156  NA &lt;NA&gt;                     NA
NA.157  NA &lt;NA&gt;                     NA
226    226  226                    Inf
227    227  227                    Inf
NA.158  NA &lt;NA&gt;                     NA
229    229  229                    Inf
230    230  230                    Inf
231    231  231                    Inf
232    232  232                    Inf
NA.159  NA &lt;NA&gt;                     NA
NA.160  NA &lt;NA&gt;                     NA
NA.161  NA &lt;NA&gt;                     NA
NA.162  NA &lt;NA&gt;                     NA
NA.163  NA &lt;NA&gt;                     NA
NA.164  NA &lt;NA&gt;                     NA
NA.165  NA &lt;NA&gt;                     NA
NA.166  NA &lt;NA&gt;                     NA
241    241  241                    Inf
NA.167  NA &lt;NA&gt;                     NA
243    243  243                    Inf
NA.168  NA &lt;NA&gt;                     NA
NA.169  NA &lt;NA&gt;                     NA
NA.170  NA &lt;NA&gt;                     NA
NA.171  NA &lt;NA&gt;                     NA
248    248  248                    Inf
NA.172  NA &lt;NA&gt;                     NA
250    250  250                    Inf
251    251  251                    Inf
NA.173  NA &lt;NA&gt;                     NA
NA.174  NA &lt;NA&gt;                     NA
254    254  254                    Inf
255    255  255                    Inf
256    256  256                    Inf
257    257  257                    Inf
258    258  258                    Inf
259    259  259                    Inf
NA.175  NA &lt;NA&gt;                     NA
261    261  261                    Inf
NA.176  NA &lt;NA&gt;                     NA
263    263  263                    Inf
264    264  264                    Inf
265    265  265                    Inf
266    266  266                    Inf
267    267  267                    Inf
NA.177  NA &lt;NA&gt;                     NA
NA.178  NA &lt;NA&gt;                     NA
NA.179  NA &lt;NA&gt;                     NA
271    271  271                    Inf
NA.180  NA &lt;NA&gt;                     NA
NA.181  NA &lt;NA&gt;                     NA
274    274  274                    Inf
NA.182  NA &lt;NA&gt;                     NA
NA.183  NA &lt;NA&gt;                     NA
277    277  277                    Inf
278    278  278                    Inf
NA.184  NA &lt;NA&gt;                     NA
NA.185  NA &lt;NA&gt;                     NA
NA.186  NA &lt;NA&gt;                     NA
NA.187  NA &lt;NA&gt;                     NA
283    283  283                    Inf
NA.188  NA &lt;NA&gt;                     NA
NA.189  NA &lt;NA&gt;                     NA
NA.190  NA &lt;NA&gt;                     NA
NA.191  NA &lt;NA&gt;                     NA
288    288  288                    Inf
NA.192  NA &lt;NA&gt;                     NA
NA.193  NA &lt;NA&gt;                     NA
291    291  291                    Inf
292    292  292                    Inf
NA.194  NA &lt;NA&gt;                     NA
NA.195  NA &lt;NA&gt;                     NA
NA.196  NA &lt;NA&gt;                     NA
296    296  296                    Inf
NA.197  NA &lt;NA&gt;                     NA
NA.198  NA &lt;NA&gt;                     NA
NA.199  NA &lt;NA&gt;                     NA
NA.200  NA &lt;NA&gt;                     NA
NA.201  NA &lt;NA&gt;                     NA
302    302  302                    Inf
303    303  303                    Inf
304    304  304                    Inf
NA.202  NA &lt;NA&gt;                     NA
NA.203  NA &lt;NA&gt;                     NA
NA.204  NA &lt;NA&gt;                     NA
NA.205  NA &lt;NA&gt;                     NA
NA.206  NA &lt;NA&gt;                     NA
NA.207  NA &lt;NA&gt;                     NA
NA.208  NA &lt;NA&gt;                     NA
NA.209  NA &lt;NA&gt;                     NA
313    313  313                    Inf
314    314  314                    Inf
315    315  315                    Inf
316    316  316                    Inf
317    317  317                    Inf
NA.210  NA &lt;NA&gt;                     NA
NA.211  NA &lt;NA&gt;                     NA
NA.212  NA &lt;NA&gt;                     NA
NA.213  NA &lt;NA&gt;                     NA
NA.214  NA &lt;NA&gt;                     NA
NA.215  NA &lt;NA&gt;                     NA
NA.216  NA &lt;NA&gt;                     NA
325    325  325                    Inf
NA.217  NA &lt;NA&gt;                     NA
327    327  327                    Inf
NA.218  NA &lt;NA&gt;                     NA
329    329  329                    Inf
330    330  330                    Inf
331    331  331                    Inf
332    332  332                    Inf
NA.219  NA &lt;NA&gt;                     NA
334    334  334                    Inf
NA.220  NA &lt;NA&gt;                     NA
336    336  336                    Inf
NA.221  NA &lt;NA&gt;                     NA
NA.222  NA &lt;NA&gt;                     NA
339    339  339                    Inf
NA.223  NA &lt;NA&gt;                     NA
341    341  341                    Inf
342    342  342                    Inf
NA.224  NA &lt;NA&gt;                     NA
NA.225  NA &lt;NA&gt;                     NA
NA.226  NA &lt;NA&gt;                     NA
346    346  346                    Inf
NA.227  NA &lt;NA&gt;                     NA
348    348  348                    Inf
NA.228  NA &lt;NA&gt;                     NA
NA.229  NA &lt;NA&gt;                     NA
351    351  351                    Inf
352    352  352                    Inf
353    353  353                    Inf
NA.230  NA &lt;NA&gt;                     NA
NA.231  NA &lt;NA&gt;                     NA
356    356  356                    Inf
NA.232  NA &lt;NA&gt;                     NA
NA.233  NA &lt;NA&gt;                     NA
359    359  359                    Inf
360    360  360                    Inf
NA.234  NA &lt;NA&gt;                     NA
NA.235  NA &lt;NA&gt;                     NA
NA.236  NA &lt;NA&gt;                     NA
NA.237  NA &lt;NA&gt;                     NA
NA.238  NA &lt;NA&gt;                     NA
NA.239  NA &lt;NA&gt;                     NA
NA.240  NA &lt;NA&gt;                     NA
NA.241  NA &lt;NA&gt;                     NA
369    369  369                    Inf
370    370  370                    Inf
NA.242  NA &lt;NA&gt;                     NA
372    372  372                    Inf
NA.243  NA &lt;NA&gt;                     NA
374    374  374                    Inf
NA.244  NA &lt;NA&gt;                     NA
NA.245  NA &lt;NA&gt;                     NA
NA.246  NA &lt;NA&gt;                     NA
NA.247  NA &lt;NA&gt;                     NA
379    379  379                    Inf
NA.248  NA &lt;NA&gt;                     NA
NA.249  NA &lt;NA&gt;                     NA
NA.250  NA &lt;NA&gt;                     NA
383    383  383                    Inf
NA.251  NA &lt;NA&gt;                     NA
NA.252  NA &lt;NA&gt;                     NA
NA.253  NA &lt;NA&gt;                     NA
387    387  387                    Inf
NA.254  NA &lt;NA&gt;                     NA
NA.255  NA &lt;NA&gt;                     NA
NA.256  NA &lt;NA&gt;                     NA
NA.257  NA &lt;NA&gt;                     NA
NA.258  NA &lt;NA&gt;                     NA
393    393  393                    Inf
NA.259  NA &lt;NA&gt;                     NA
NA.260  NA &lt;NA&gt;                     NA
NA.261  NA &lt;NA&gt;                     NA
397    397  397                    Inf
398    398  398                    Inf
399    399  399                    Inf
NA.262  NA &lt;NA&gt;                     NA
NA.263  NA &lt;NA&gt;                     NA
NA.264  NA &lt;NA&gt;                     NA
NA.265  NA &lt;NA&gt;                     NA
NA.266  NA &lt;NA&gt;                     NA
405    405  405                    Inf
NA.267  NA &lt;NA&gt;                     NA
NA.268  NA &lt;NA&gt;                     NA
NA.269  NA &lt;NA&gt;                     NA
NA.270  NA &lt;NA&gt;                     NA
NA.271  NA &lt;NA&gt;                     NA
411    411  411                    Inf
NA.272  NA &lt;NA&gt;                     NA
NA.273  NA &lt;NA&gt;                     NA
NA.274  NA &lt;NA&gt;                     NA
NA.275  NA &lt;NA&gt;                     NA
NA.276  NA &lt;NA&gt;                     NA
417    417  417                    Inf
418    418  418                    Inf
419    419  419                    Inf
NA.277  NA &lt;NA&gt;                     NA
NA.278  NA &lt;NA&gt;                     NA
NA.279  NA &lt;NA&gt;                     NA
NA.280  NA &lt;NA&gt;                     NA
NA.281  NA &lt;NA&gt;                     NA
425    425  425                    Inf
426    426  426                    Inf
NA.282  NA &lt;NA&gt;                     NA
NA.283  NA &lt;NA&gt;                     NA
NA.284  NA &lt;NA&gt;                     NA
NA.285  NA &lt;NA&gt;                     NA
NA.286  NA &lt;NA&gt;                     NA
432    432  432                    Inf
433    433  433                    Inf
NA.287  NA &lt;NA&gt;                     NA
NA.288  NA &lt;NA&gt;                     NA
NA.289  NA &lt;NA&gt;                     NA
NA.290  NA &lt;NA&gt;                     NA
NA.291  NA &lt;NA&gt;                     NA
NA.292  NA &lt;NA&gt;                     NA
NA.293  NA &lt;NA&gt;                     NA
NA.294  NA &lt;NA&gt;                     NA
NA.295  NA &lt;NA&gt;                     NA
NA.296  NA &lt;NA&gt;                     NA
444    444  444                    Inf
445    445  445                    Inf
NA.297  NA &lt;NA&gt;                     NA
NA.298  NA &lt;NA&gt;                     NA
448    448  448                    Inf
449    449  449                    Inf
NA.299  NA &lt;NA&gt;                     NA
NA.300  NA &lt;NA&gt;                     NA
NA.301  NA &lt;NA&gt;                     NA
NA.302  NA &lt;NA&gt;                     NA</code></pre>
</div>
</div>
<p>Questo risultato dipende dal fatto che la distribuzione è estremamente asimmetrica. Otteniamo risultati simili per tutti gli item che hanno una distribuzione asimmetrica.</p>
</section>
<section id="outlier-multidimensionali" class="level3">
<h3 class="anchored" data-anchor-id="outlier-multidimensionali">Outlier multidimensionali</h3>
<p>Più che gli outlier unidimensionali sono importanti gli outlier multidimensionali. Se i dati seguono una distribuzione normale multivariata, l’identificazione degli outlier può procedere calcolando la distanza di Mahalanobis.</p>
<section id="distanza-di-mahalanobis" class="level4">
<h4 class="anchored" data-anchor-id="distanza-di-mahalanobis">Distanza di Mahalanobis</h4>
<p>La distanza di Mahalanobis è una misura della distanza tra un punto e il centro di una distribuzione una distribuzione multivariata. Diversamente dalla distanza euclidea, la distanza di Mahalanobis tiene conto della correlazione tra le variabili e della scala delle variabili. Questa misura è utile per identificare outlier in un contesto multivariato.</p>
<p>La formula della distanza di Mahalanobis è:</p>
<p><span class="math display">\[
D_M(x) = \sqrt{(x - \mu)^T S^{-1} (x - \mu)},
\]</span></p>
<p>dove:</p>
<ul>
<li><span class="math inline">\(x\)</span> è il vettore del punto di cui si vuole calcolare la distanza.</li>
<li><span class="math inline">\(\mu\)</span> è il vettore della media della distribuzione.</li>
<li><span class="math inline">\(S\)</span> è la matrice di covarianza della distribuzione.</li>
<li><span class="math inline">\(S^{-1}\)</span> è l’inversa della matrice di covarianza.</li>
<li><span class="math inline">\((x - \mu)^T\)</span> è la trasposta del vettore <span class="math inline">\((x - \mu)\)</span>.</li>
</ul>
<p>Nel caso bidimensionale, possiamo visualizzare la distanza di Mahalanobis come segue:</p>
<ol type="1">
<li>Immagina un diagramma a dispersione dei dati, dove ogni punto rappresenta un’osservazione con due variabili.</li>
<li>Il centro della distribuzione <span class="math inline">\(\mu\)</span> sarà un punto in questo spazio bidimensionale.</li>
<li>La matrice di covarianza <span class="math inline">\(S\)</span> descrive la forma e l’orientamento dell’ellisse che rappresenta la distribuzione dei dati.</li>
<li>La distanza di Mahalanobis essenzialmente “normalizza” lo spazio, trasformando l’ellisse in un cerchio.</li>
<li>In questo spazio normalizzato, la distanza di Mahalanobis è equivalente alla distanza euclidea dal centro.</li>
<li>Punti che si trovano sulla stessa ellisse avranno la stessa distanza di Mahalanobis dal centro, anche se le loro distanze euclidee potrebbero essere diverse.</li>
</ol>
<p>In pratica, la distanza di Mahalanobis tiene conto non solo della distanza dal centro (come farebbe la distanza euclidea), ma anche della direzione rispetto alla distribuzione dei dati. Questo la rende particolarmente utile quando le variabili sono correlate o hanno scale diverse.</p>
<p>Nel caso presente, in cui i dati non seguono una distribuzione normale multivariata, una versione robusta (che utilizza medie basate sui quantili e covarianza calcolata su sottoinsiemi di dati selezionati in modo da escludere gli outlier) della distanza di Mahalanobis otteniamo un grande numero di outlier.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">check_outliers</span>(mydata, <span class="at">method =</span> <span class="st">"mcd"</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>outliers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>56 outliers detected: cases 9, 18, 36, 37, 39, 53, 60, 65, 82, 83, 87,
  100, 109, 116, 136, 147, 155, 157, 168, 172, 173, 179, 187, 195, 204,
  210, 220, 221, 227, 228, 230, 240, 243, 258, 263, 293, 294, 300, 308,
  317, 319, 329, 330, 335, 338, 339, 340, 349, 350, 352, 354, 356, 367,
  406, 416, 432.
- Based on the following method and threshold: mcd (30).
- For variables: FAI_86, FAI_1, FAI_47, FAI_121, FAI_57, FAI_167,
  FAI_91, FAI_99, FAI_135, FAI_163.</code></pre>
</div>
</div>
<p>Anche questo risultato può essere attribuito al fatto che la distribuzione di alcuni item è fortemente asimmetrica.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw1b_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="isolation-forest" class="level4">
<h4 class="anchored" data-anchor-id="isolation-forest">Isolation Forest</h4>
<p>Oltre alla distanza di Mahalanobis, ci sono altri metodi robusti per l’identificazione degli outliers che possono essere meno sensibili alle distribuzioni asimmetriche. Uno di questi è <em>Isolation Forest</em>, una tecnica basata sugli alberi che può identificare outliers senza fare assunzioni sulla distribuzione dei dati.</p>
<p>Consideriamo un esempio con valori estratti dalla distribuzione normale, a cui aggiungiamo un outlier.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># aggiungo un outlier</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>random_numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(random_numbers, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">col=</span><span class="st">"navy"</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Randomly-generated numbers</span><span class="sc">\n</span><span class="st">from normal distribution"</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw1b_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Isolation Forest individua il valore outlier.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">isolation.forest</span>(random_numbers, <span class="at">ndim=</span><span class="dv">1</span>, <span class="at">ntrees=</span><span class="dv">10</span>, <span class="at">nthreads=</span><span class="dv">1</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, random_numbers, <span class="at">type=</span><span class="st">"avg_depth"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(random_numbers, scores, <span class="at">type=</span><span class="st">"p"</span>, <span class="at">col=</span><span class="st">"darkred"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Average isolation depth</span><span class="sc">\n</span><span class="st">for normally-distributed numbers"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"value"</span>, <span class="at">ylab=</span><span class="st">"Average isolation depth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw1b_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Consideriamo ora un secondo esempio in cui la distribuzione è asimmetrica (chi-quadrato con un grado di libertà). Anche a questo campione casuale aggiungiamo un valore outlier.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rchisq</span>(<span class="dv">1000</span>, <span class="dv">1</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># aggiungo un outlier</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>random_numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="dv">30</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(random_numbers, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">col=</span><span class="st">"navy"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Randomly-generated numbers</span><span class="sc">\n</span><span class="st">from chi-squared distribution"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw1b_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Anche in questo caso Isolation Forest è in grado di individuare il valore anomalo.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">isolation.forest</span>(random_numbers, <span class="at">ndim=</span><span class="dv">1</span>, <span class="at">ntrees=</span><span class="dv">10</span>, <span class="at">nthreads=</span><span class="dv">1</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, random_numbers, <span class="at">type=</span><span class="st">"avg_depth"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(random_numbers, scores, <span class="at">type=</span><span class="st">"p"</span>, <span class="at">col=</span><span class="st">"darkred"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Average isolation depth</span><span class="sc">\n</span><span class="st">for chi-squared distributed numbers"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"value"</span>, <span class="at">ylab=</span><span class="st">"Average isolation depth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw1b_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Sebbene i casi sopra menzionati possano essere utili per comprendere il funzionamento dell’Isolation Forest, l’identificazione degli outlier in dati unidimensionali e bidimensionali è un’area in cui sono stati provati e dimostrati con successo molti altri metodi. Tuttavia, l’Isolation Forest eccelle quando i dati hanno un numero elevato di dimensioni, outlier raggruppati o distribuzioni multi-modali. Questo è il caso dei dati reali in molte applicazioni psicologiche, come nel caso presente. Pertanto, applichiamo l’algoritmo Isolation Forest al dataset che include simultaneamente tutti gli item che stiamo considerando.</p>
<p>Creiamo un modello Isolation Forest con parametri specificati.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">isolation.forest</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  mydata, <span class="co"># Escludere la colonna "id"</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndim =</span> <span class="dv">1</span>, <span class="co"># Dimensione dei sotto-spazi selezionati casualmente</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_size =</span> <span class="dv">256</span>, <span class="co"># Dimensione del campione per costruire ciascun albero</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntrees =</span> <span class="dv">1000</span>, <span class="co"># Numero di alberi nella foresta</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing_action =</span> <span class="st">"fail"</span> <span class="co"># Azione in caso di dati mancanti</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in isolation.forest(mydata, ndim = 1, sample_size = 256, ntrees = 1000,
: Attempting to use more than 1 thread, but package was compiled without OpenMP
support. See
https://github.com/david-cortes/installing-optimized-libraries#4-macos-install-and-enable-openmp</code></pre>
</div>
</div>
<p>Predizione degli outliers.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I valori prodotti dalla funzione <code>predict</code> possono essere interpretati come misure di quanto un dato punto sia un outlier. <code>Anomaly Score</code> (<code>type="anomaly_score"</code> o predefinito): valori più alti indicano una maggiore probabilità che il punto sia un outlier.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  scores, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">col=</span><span class="st">"navy"</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Outlier scores"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">"Values"</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw1b_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>L’istogramma degli <code>Anomaly Score</code> non rivela la presenza di outlier.</p>
<p>Quando invece abbiamo evidenza che alcune osservazioni sono outliers, è importante procedere con attenzione per garantire che l’analisi successiva sia accurata. Di seguito viene descritto un metodo per identificare, segnare e gestire gli outliers nei dati.</p>
</section>
<section id="passaggi-per-identificare-e-gestire-gli-outliers" class="level4">
<h4 class="anchored" data-anchor-id="passaggi-per-identificare-e-gestire-gli-outliers">Passaggi per Identificare e Gestire gli Outliers</h4>
<ol type="1">
<li><p><strong>Individuare gli Outliers</strong>: Utilizzando l’algoritmo Isolation Forest, possiamo calcolare i punteggi di outlier per ogni osservazione. Supponiamo che i punteggi alti indichino una maggiore probabilità di essere un outlier. In questo esempio, utilizziamo una soglia di 0.6 per determinare quali osservazioni sono outliers.</p></li>
<li><p><strong>Aggiungere una Colonna <code>outlier</code></strong>: Aggiungiamo una colonna al nostro dataset per indicare se un’osservazione è considerata un outlier (TRUE) o meno (FALSE).</p></li>
<li><p><strong>Visualizzare le Osservazioni Outliers</strong>: Filtriamo e visualizziamo le osservazioni che sono state classificate come outliers.</p></li>
<li><p><strong>Gestire gli Outliers</strong>: Abbiamo due opzioni principali per gestire gli outliers:</p>
<ul>
<li>Escludere le osservazioni che contengono outliers.</li>
<li>Sostituire le osservazioni outliers con valori mancanti (NA) e successivamente utilizzare una procedura di imputazione multipla per trattare i dati mancanti. Questa seconda opzione è generalmente preferibile, in quanto permette di mantenere tutte le informazioni disponibili nel dataset.</li>
</ul></li>
</ol>
<p>Gestire correttamente gli outliers è cruciale per l’accuratezza delle analisi. Utilizzando una soglia per identificare gli outliers e scegliendo una delle due opzioni di gestione presentate, possiamo migliorare la qualità dei nostri dati e ottenere risultati più affidabili nelle nostre analisi. La procedura di imputazione multipla è spesso preferibile in quanto preserva l’informazione completa del dataset.</p>


<!-- -->


</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-dima2018scale" class="csl-entry" role="listitem">
Dima, Alexandra L. 2018. <span>“Scale Validation in Applied Health Research: Tutorial for a 6-Step r-Based Psychometrics Protocol.”</span> <em>Health Psychology and Behavioral Medicine</em> 6 (1): 136–61.
</div>
<div id="ref-theriault2024check" class="csl-entry" role="listitem">
Thériault, Rémi, Mattan S Ben-Shachar, Indrajeet Patil, Daniel Lüdecke, Brenton M Wiernik, and Dominique Makowski. 2024. <span>“Check Your Outliers﻿! An Introduction to Identifying Statistical Outliers in r with Easystats.”</span> <em>Behavior Research Methods</em> 56 (4): 4162–72.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/lab-test-psi-quarto\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb35" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Statistiche descrittive a livello degli item"</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> ../references.bib</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>La prima fase della selezione degli item e validazione di un questionario riguarda le statistiche descrittive degli item. Nella prima fase dell'analisi, @dima2018scale propone di esaminare gli aspetti seguenti.</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Frequenze delle risposte e le statistiche degli item.** Le frequenze delle risposte e le statistiche degli item vengono esaminate per valutare se gli item mostrano una sufficiente variazione, in modo da poter differenziare i rispondenti rispetto al/i costrutto/i investigato/i e se ci sono valori fuori range (errori di inserimento dei dati). Le differenze nelle frequenze delle risposte forniscono anche un primo indizio riguardo alla variazione nell'intensità/difficoltà degli item (e aiutano a interpretare eventuali differenze successive tra i risultati di IRT e FA). </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Associazioni tra gli item.** Le associazioni tra gli item vengono esaminate per identificare eventuali correlazioni negative (e codificare tali item al contrario per le analisi successive). </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Outlier.** L'individuazione degli outlier multivariati aiuta a identificare eventuali rispondenti con pattern di risposta idiosincratici, che possono essere ulteriormente investigati ed eventualmente esclusi (ad esempio, se vengono identificati errori nella raccolta/inserimento dei dati) o mantenuti nel campione (se non ci sono validi motivi per l'esclusione). Oppure possiamo rimuovere i valori anomali e procedure con l'imputazione multipla dei dati mancanti.</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"cleaned_data.csv"</span>))</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(rio)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MASS)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(corrplot)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(outliers)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(performance)</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(see)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(isotree)</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>Seleziono gli item della sottoscala "Problemi comportamentali" dell'Area 1 "Caratterisriche del bambino". </span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>item_codes <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"aree_tematiche_items.csv"</span>))</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>behav_problems_item_names <span class="ot">&lt;-</span> item_codes[<span class="dv">6</span><span class="sc">:</span><span class="dv">16</span>, ]<span class="sc">$</span>Item_Code</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>behav_problems_item_names</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>L'item FAI_152 è stato eliminato in precedenza.</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FAI_86"</span>, <span class="st">"FAI_1"</span>, <span class="st">"FAI_47"</span>, <span class="st">"FAI_121"</span>, <span class="st">"FAI_57"</span>, <span class="st">"FAI_167"</span>, </span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FAI_91"</span>, <span class="st">"FAI_99"</span>, <span class="st">"FAI_135"</span>, <span class="st">"FAI_163"</span> </span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(selected_columns))</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribuzioni di risposte</span></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>myitems <span class="ot">&lt;-</span> <span class="fu">names</span>(mydata)</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( n <span class="cf">in</span> myitems)</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>( <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, n, <span class="st">":"</span> );</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">table</span>( mydata[,n], <span class="at">exclude=</span><span class="cn">NULL</span> ) );</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>Verificare se le variabili sono codificate come numeriche.</span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mydata[, <span class="dv">1</span>])</span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a><span class="co"># File to write the summaries</span></span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>summaries.file <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"summaries.txt"</span>)</span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to write summary for a variable</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a>write.summary.var <span class="ot">&lt;-</span> <span class="cf">function</span>(x, xname) {</span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>    a1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a>    a2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>    a3 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a>    a4 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">3</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>    a5 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">4</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>    total_non_na <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x))  <span class="co"># Total non-NA values</span></span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a>    a6 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">sum</span>(x <span class="sc">&lt;=</span> <span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> total_non_na), <span class="dv">2</span>)</span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a>    a7 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">sum</span>(x <span class="sc">&gt;</span> <span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> total_non_na), <span class="dv">2</span>)</span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a>    a8 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(x))</span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(xname, a1, a2, a3, a4, a5, a6, a7, a8, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">file =</span> summaries.file, <span class="at">append =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. For each item, run this function iteratively</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> myitems) {</span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.summary.var</span>(mydata[, n], n)</span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the table in R</span></span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a>myitemssum <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"summaries.txt"</span>), <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="st">"</span><span class="sc">\"</span><span class="st">"</span>)</span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Add column names</span></span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(myitemssum) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Item label"</span>, <span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"% 0 to 2"</span>, </span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"% 2 to 4"</span>, <span class="st">"No. missing"</span>)</span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the result</span></span>
<span id="cb35-123"><a href="#cb35-123" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(myitemssum)</span>
<span id="cb35-124"><a href="#cb35-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a><span class="fu">## Statistiche descrittive</span></span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-130"><a href="#cb35-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-131"><a href="#cb35-131" aria-hidden="true" tabindex="-1"></a>descrmyitems <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>( <span class="fu">round</span>( psych<span class="sc">::</span><span class="fu">describe</span>( mydata ), <span class="dv">2</span> ))</span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a>descrmyitems</span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-134"><a href="#cb35-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-137"><a href="#cb35-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-138"><a href="#cb35-138" aria-hidden="true" tabindex="-1"></a><span class="co"># order items based on percentage based on the 8th column (% high scores)</span></span>
<span id="cb35-139"><a href="#cb35-139" aria-hidden="true" tabindex="-1"></a>myitemssumOrder <span class="ot">&lt;-</span> myitemssum[<span class="fu">order</span>(myitemssum[, <span class="dv">8</span>]),] </span>
<span id="cb35-140"><a href="#cb35-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-141"><a href="#cb35-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-144"><a href="#cb35-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-145"><a href="#cb35-145" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(myitemssumOrder[,<span class="st">"% 2 to 4"</span>], </span>
<span id="cb35-146"><a href="#cb35-146" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"High score frequencies for items"</span>,</span>
<span id="cb35-147"><a href="#cb35-147" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Items"</span>, </span>
<span id="cb35-148"><a href="#cb35-148" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Number of respondents"</span>, </span>
<span id="cb35-149"><a href="#cb35-149" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.lab=</span><span class="fl">0.8</span>,</span>
<span id="cb35-150"><a href="#cb35-150" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.axis=</span><span class="fl">0.8</span>,</span>
<span id="cb35-151"><a href="#cb35-151" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg=</span>myitemssumOrder[, <span class="st">"Item label"</span>], </span>
<span id="cb35-152"><a href="#cb35-152" aria-hidden="true" tabindex="-1"></a>        <span class="at">las=</span><span class="dv">2</span>, </span>
<span id="cb35-153"><a href="#cb35-153" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.names=</span><span class="fl">0.6</span>)</span>
<span id="cb35-154"><a href="#cb35-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-155"><a href="#cb35-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-158"><a href="#cb35-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-159"><a href="#cb35-159" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>( <span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)) <span class="co"># set several plots per rows and columns</span></span>
<span id="cb35-160"><a href="#cb35-160" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( n <span class="cf">in</span> myitems)</span>
<span id="cb35-161"><a href="#cb35-161" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb35-162"><a href="#cb35-162" aria-hidden="true" tabindex="-1"></a>  distr <span class="ot">&lt;-</span> <span class="fu">table</span>(mydata[,n])</span>
<span id="cb35-163"><a href="#cb35-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">barplot</span>(distr,  </span>
<span id="cb35-164"><a href="#cb35-164" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span>n, </span>
<span id="cb35-165"><a href="#cb35-165" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="fu">gray.colors</span>(<span class="dv">20</span>), </span>
<span id="cb35-166"><a href="#cb35-166" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Number of respondents"</span>, </span>
<span id="cb35-167"><a href="#cb35-167" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Response (0=Negative, 4=Positive)"</span>);</span>
<span id="cb35-168"><a href="#cb35-168" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-169"><a href="#cb35-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-170"><a href="#cb35-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-171"><a href="#cb35-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlazioni tra gli item</span></span>
<span id="cb35-172"><a href="#cb35-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-175"><a href="#cb35-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-176"><a href="#cb35-176" aria-hidden="true" tabindex="-1"></a><span class="co"># for ordinal items use Spearman correlations</span></span>
<span id="cb35-177"><a href="#cb35-177" aria-hidden="true" tabindex="-1"></a>bluesqs <span class="ot">&lt;-</span> <span class="fu">cor</span>(mydata, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb35-178"><a href="#cb35-178" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(bluesqs, <span class="at">method =</span> <span class="st">"number"</span>, <span class="at">main =</span> <span class="st">"Correlations Between Items"</span>, </span>
<span id="cb35-179"><a href="#cb35-179" aria-hidden="true" tabindex="-1"></a>         <span class="at">number.cex =</span> <span class="fl">0.5</span>, <span class="at">tl.cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb35-180"><a href="#cb35-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-181"><a href="#cb35-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-182"><a href="#cb35-182" aria-hidden="true" tabindex="-1"></a><span class="fu">## Outliers</span></span>
<span id="cb35-183"><a href="#cb35-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-184"><a href="#cb35-184" aria-hidden="true" tabindex="-1"></a>Per l'esame degli outlier useremo le funzionalità del pacchetto <span class="co">[</span><span class="ot">`performance`</span><span class="co">](https://easystats.github.io/performance/articles/check_outliers.html)[</span><span class="ot">@theriault2024check</span><span class="co">]</span>.</span>
<span id="cb35-185"><a href="#cb35-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-186"><a href="#cb35-186" aria-hidden="true" tabindex="-1"></a><span class="fu">### Outlier unidimensionali</span></span>
<span id="cb35-187"><a href="#cb35-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-188"><a href="#cb35-188" aria-hidden="true" tabindex="-1"></a>Aggiungo la colonna <span class="in">`id`</span>.</span>
<span id="cb35-189"><a href="#cb35-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-192"><a href="#cb35-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-193"><a href="#cb35-193" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mydata) <span class="sc">|&gt;</span> <span class="fu">as.factor</span>()</span>
<span id="cb35-194"><a href="#cb35-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-195"><a href="#cb35-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-198"><a href="#cb35-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-199"><a href="#cb35-199" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> mydata <span class="sc">|&gt;</span> </span>
<span id="cb35-200"><a href="#cb35-200" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, FAI_86)</span>
<span id="cb35-201"><a href="#cb35-201" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">check_outliers</span>(foo, <span class="at">method =</span> <span class="st">"zscore_robust"</span>, <span class="at">ID =</span> <span class="st">"id"</span>)</span>
<span id="cb35-202"><a href="#cb35-202" aria-hidden="true" tabindex="-1"></a>outliers</span>
<span id="cb35-203"><a href="#cb35-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-204"><a href="#cb35-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-207"><a href="#cb35-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-208"><a href="#cb35-208" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> mydata <span class="sc">|&gt;</span> </span>
<span id="cb35-209"><a href="#cb35-209" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, FAI_1)</span>
<span id="cb35-210"><a href="#cb35-210" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">check_outliers</span>(foo, <span class="at">method =</span> <span class="st">"zscore_robust"</span>, <span class="at">ID =</span> <span class="st">"id"</span>)</span>
<span id="cb35-211"><a href="#cb35-211" aria-hidden="true" tabindex="-1"></a>outliers</span>
<span id="cb35-212"><a href="#cb35-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-213"><a href="#cb35-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-214"><a href="#cb35-214" aria-hidden="true" tabindex="-1"></a>Questo risultato dipende dal fatto che la distribuzione è estremamente asimmetrica. Otteniamo risultati simili per tutti gli item che hanno una distribuzione asimmetrica.</span>
<span id="cb35-215"><a href="#cb35-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-216"><a href="#cb35-216" aria-hidden="true" tabindex="-1"></a><span class="fu">### Outlier multidimensionali</span></span>
<span id="cb35-217"><a href="#cb35-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-218"><a href="#cb35-218" aria-hidden="true" tabindex="-1"></a>Più che gli outlier unidimensionali sono importanti gli outlier multidimensionali. Se i dati seguono una distribuzione normale multivariata, l'identificazione degli outlier può procedere calcolando la distanza di Mahalanobis. </span>
<span id="cb35-219"><a href="#cb35-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-220"><a href="#cb35-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-221"><a href="#cb35-221" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Distanza di Mahalanobis</span></span>
<span id="cb35-222"><a href="#cb35-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-223"><a href="#cb35-223" aria-hidden="true" tabindex="-1"></a>La distanza di Mahalanobis è una misura della distanza tra un punto e il centro di una distribuzione una distribuzione multivariata. Diversamente dalla distanza euclidea, la distanza di Mahalanobis tiene conto della correlazione tra le variabili e della scala delle variabili. Questa misura è utile per identificare outlier in un contesto multivariato. </span>
<span id="cb35-224"><a href="#cb35-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-225"><a href="#cb35-225" aria-hidden="true" tabindex="-1"></a>La formula della distanza di Mahalanobis è:</span>
<span id="cb35-226"><a href="#cb35-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-227"><a href="#cb35-227" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb35-228"><a href="#cb35-228" aria-hidden="true" tabindex="-1"></a>D_M(x) = \sqrt{(x - \mu)^T S^{-1} (x - \mu)}, </span>
<span id="cb35-229"><a href="#cb35-229" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb35-230"><a href="#cb35-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-231"><a href="#cb35-231" aria-hidden="true" tabindex="-1"></a>dove:</span>
<span id="cb35-232"><a href="#cb35-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-233"><a href="#cb35-233" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$x$ è il vettore del punto di cui si vuole calcolare la distanza.</span>
<span id="cb35-234"><a href="#cb35-234" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mu$ è il vettore della media della distribuzione.</span>
<span id="cb35-235"><a href="#cb35-235" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$S$ è la matrice di covarianza della distribuzione.</span>
<span id="cb35-236"><a href="#cb35-236" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$S^{-1}$ è l'inversa della matrice di covarianza.</span>
<span id="cb35-237"><a href="#cb35-237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$(x - \mu)^T$ è la trasposta del vettore $(x - \mu)$.</span>
<span id="cb35-238"><a href="#cb35-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-239"><a href="#cb35-239" aria-hidden="true" tabindex="-1"></a>Nel caso bidimensionale, possiamo visualizzare la distanza di Mahalanobis come segue:</span>
<span id="cb35-240"><a href="#cb35-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-241"><a href="#cb35-241" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Immagina un diagramma a dispersione dei dati, dove ogni punto rappresenta un'osservazione con due variabili.</span>
<span id="cb35-242"><a href="#cb35-242" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Il centro della distribuzione $\mu$ sarà un punto in questo spazio bidimensionale.</span>
<span id="cb35-243"><a href="#cb35-243" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>La matrice di covarianza $S$ descrive la forma e l'orientamento dell'ellisse che rappresenta la distribuzione dei dati.</span>
<span id="cb35-244"><a href="#cb35-244" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>La distanza di Mahalanobis essenzialmente "normalizza" lo spazio, trasformando l'ellisse in un cerchio.</span>
<span id="cb35-245"><a href="#cb35-245" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>In questo spazio normalizzato, la distanza di Mahalanobis è equivalente alla distanza euclidea dal centro.</span>
<span id="cb35-246"><a href="#cb35-246" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Punti che si trovano sulla stessa ellisse avranno la stessa distanza di Mahalanobis dal centro, anche se le loro distanze euclidee potrebbero essere diverse.</span>
<span id="cb35-247"><a href="#cb35-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-248"><a href="#cb35-248" aria-hidden="true" tabindex="-1"></a>In pratica, la distanza di Mahalanobis tiene conto non solo della distanza dal centro (come farebbe la distanza euclidea), ma anche della direzione rispetto alla distribuzione dei dati. Questo la rende particolarmente utile quando le variabili sono correlate o hanno scale diverse.</span>
<span id="cb35-249"><a href="#cb35-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-250"><a href="#cb35-250" aria-hidden="true" tabindex="-1"></a>Nel caso presente, in cui i dati non seguono una distribuzione normale multivariata, una versione robusta (che utilizza medie basate sui quantili e covarianza calcolata su sottoinsiemi di dati selezionati in modo da escludere gli outlier) della distanza di Mahalanobis otteniamo un grande numero di outlier. </span>
<span id="cb35-251"><a href="#cb35-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-254"><a href="#cb35-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-255"><a href="#cb35-255" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-256"><a href="#cb35-256" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">check_outliers</span>(mydata, <span class="at">method =</span> <span class="st">"mcd"</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-257"><a href="#cb35-257" aria-hidden="true" tabindex="-1"></a>outliers</span>
<span id="cb35-258"><a href="#cb35-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-259"><a href="#cb35-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-260"><a href="#cb35-260" aria-hidden="true" tabindex="-1"></a>Anche questo risultato può essere attribuito al fatto che la distribuzione di alcuni item è fortemente asimmetrica.</span>
<span id="cb35-261"><a href="#cb35-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-264"><a href="#cb35-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-265"><a href="#cb35-265" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(outliers)</span>
<span id="cb35-266"><a href="#cb35-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-267"><a href="#cb35-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-268"><a href="#cb35-268" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Isolation Forest</span></span>
<span id="cb35-269"><a href="#cb35-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-270"><a href="#cb35-270" aria-hidden="true" tabindex="-1"></a>Oltre alla distanza di Mahalanobis, ci sono altri metodi robusti per l'identificazione degli outliers che possono essere meno sensibili alle distribuzioni asimmetriche. Uno di questi è *Isolation Forest*, una tecnica basata sugli alberi che può identificare outliers senza fare assunzioni sulla distribuzione dei dati.</span>
<span id="cb35-271"><a href="#cb35-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-272"><a href="#cb35-272" aria-hidden="true" tabindex="-1"></a>Consideriamo un esempio con valori estratti dalla distribuzione normale, a cui aggiungiamo un outlier.</span>
<span id="cb35-273"><a href="#cb35-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-276"><a href="#cb35-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-277"><a href="#cb35-277" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb35-278"><a href="#cb35-278" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb35-279"><a href="#cb35-279" aria-hidden="true" tabindex="-1"></a><span class="co"># aggiungo un outlier</span></span>
<span id="cb35-280"><a href="#cb35-280" aria-hidden="true" tabindex="-1"></a>random_numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb35-281"><a href="#cb35-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-282"><a href="#cb35-282" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb35-283"><a href="#cb35-283" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(random_numbers, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">col=</span><span class="st">"navy"</span>,</span>
<span id="cb35-284"><a href="#cb35-284" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Randomly-generated numbers</span><span class="sc">\n</span><span class="st">from normal distribution"</span>,</span>
<span id="cb35-285"><a href="#cb35-285" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"value"</span>)</span>
<span id="cb35-286"><a href="#cb35-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-287"><a href="#cb35-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-288"><a href="#cb35-288" aria-hidden="true" tabindex="-1"></a>Isolation Forest individua il valore outlier.</span>
<span id="cb35-289"><a href="#cb35-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-292"><a href="#cb35-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-293"><a href="#cb35-293" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">isolation.forest</span>(random_numbers, <span class="at">ndim=</span><span class="dv">1</span>, <span class="at">ntrees=</span><span class="dv">10</span>, <span class="at">nthreads=</span><span class="dv">1</span>)</span>
<span id="cb35-294"><a href="#cb35-294" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, random_numbers, <span class="at">type=</span><span class="st">"avg_depth"</span>)</span>
<span id="cb35-295"><a href="#cb35-295" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb35-296"><a href="#cb35-296" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(random_numbers, scores, <span class="at">type=</span><span class="st">"p"</span>, <span class="at">col=</span><span class="st">"darkred"</span>,</span>
<span id="cb35-297"><a href="#cb35-297" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Average isolation depth</span><span class="sc">\n</span><span class="st">for normally-distributed numbers"</span>,</span>
<span id="cb35-298"><a href="#cb35-298" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"value"</span>, <span class="at">ylab=</span><span class="st">"Average isolation depth"</span>)</span>
<span id="cb35-299"><a href="#cb35-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-300"><a href="#cb35-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-301"><a href="#cb35-301" aria-hidden="true" tabindex="-1"></a>Consideriamo ora un secondo esempio in cui la distribuzione è asimmetrica (chi-quadrato con un grado di libertà). Anche a questo campione casuale aggiungiamo un valore outlier.</span>
<span id="cb35-302"><a href="#cb35-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-305"><a href="#cb35-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-306"><a href="#cb35-306" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb35-307"><a href="#cb35-307" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rchisq</span>(<span class="dv">1000</span>, <span class="dv">1</span>))</span>
<span id="cb35-308"><a href="#cb35-308" aria-hidden="true" tabindex="-1"></a><span class="co"># aggiungo un outlier</span></span>
<span id="cb35-309"><a href="#cb35-309" aria-hidden="true" tabindex="-1"></a>random_numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="dv">30</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb35-310"><a href="#cb35-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-311"><a href="#cb35-311" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb35-312"><a href="#cb35-312" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(random_numbers, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">col=</span><span class="st">"navy"</span>,</span>
<span id="cb35-313"><a href="#cb35-313" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Randomly-generated numbers</span><span class="sc">\n</span><span class="st">from chi-squared distribution"</span>,</span>
<span id="cb35-314"><a href="#cb35-314" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"value"</span>)</span>
<span id="cb35-315"><a href="#cb35-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-316"><a href="#cb35-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-317"><a href="#cb35-317" aria-hidden="true" tabindex="-1"></a>Anche in questo caso Isolation Forest è in grado di individuare il valore anomalo.</span>
<span id="cb35-318"><a href="#cb35-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-321"><a href="#cb35-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-322"><a href="#cb35-322" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">isolation.forest</span>(random_numbers, <span class="at">ndim=</span><span class="dv">1</span>, <span class="at">ntrees=</span><span class="dv">10</span>, <span class="at">nthreads=</span><span class="dv">1</span>)</span>
<span id="cb35-323"><a href="#cb35-323" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, random_numbers, <span class="at">type=</span><span class="st">"avg_depth"</span>)</span>
<span id="cb35-324"><a href="#cb35-324" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb35-325"><a href="#cb35-325" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(random_numbers, scores, <span class="at">type=</span><span class="st">"p"</span>, <span class="at">col=</span><span class="st">"darkred"</span>,</span>
<span id="cb35-326"><a href="#cb35-326" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Average isolation depth</span><span class="sc">\n</span><span class="st">for chi-squared distributed numbers"</span>,</span>
<span id="cb35-327"><a href="#cb35-327" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"value"</span>, <span class="at">ylab=</span><span class="st">"Average isolation depth"</span>)</span>
<span id="cb35-328"><a href="#cb35-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-329"><a href="#cb35-329" aria-hidden="true" tabindex="-1"></a>Sebbene i casi sopra menzionati possano essere utili per comprendere il funzionamento dell'Isolation Forest, l'identificazione degli outlier in dati unidimensionali e bidimensionali è un'area in cui sono stati provati e dimostrati con successo molti altri metodi. Tuttavia, l'Isolation Forest eccelle quando i dati hanno un numero elevato di dimensioni, outlier raggruppati o distribuzioni multi-modali. Questo è il caso dei dati reali in molte applicazioni psicologiche, come nel caso presente. Pertanto, applichiamo l'algoritmo Isolation Forest al dataset che include simultaneamente tutti gli item che stiamo considerando.</span>
<span id="cb35-330"><a href="#cb35-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-331"><a href="#cb35-331" aria-hidden="true" tabindex="-1"></a>Creiamo un modello Isolation Forest con parametri specificati.</span>
<span id="cb35-332"><a href="#cb35-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-335"><a href="#cb35-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-336"><a href="#cb35-336" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">isolation.forest</span>(</span>
<span id="cb35-337"><a href="#cb35-337" aria-hidden="true" tabindex="-1"></a>  mydata, <span class="co"># Escludere la colonna "id"</span></span>
<span id="cb35-338"><a href="#cb35-338" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndim =</span> <span class="dv">1</span>, <span class="co"># Dimensione dei sotto-spazi selezionati casualmente</span></span>
<span id="cb35-339"><a href="#cb35-339" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_size =</span> <span class="dv">256</span>, <span class="co"># Dimensione del campione per costruire ciascun albero</span></span>
<span id="cb35-340"><a href="#cb35-340" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntrees =</span> <span class="dv">1000</span>, <span class="co"># Numero di alberi nella foresta</span></span>
<span id="cb35-341"><a href="#cb35-341" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing_action =</span> <span class="st">"fail"</span> <span class="co"># Azione in caso di dati mancanti</span></span>
<span id="cb35-342"><a href="#cb35-342" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-343"><a href="#cb35-343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-344"><a href="#cb35-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-345"><a href="#cb35-345" aria-hidden="true" tabindex="-1"></a>Predizione degli outliers.</span>
<span id="cb35-346"><a href="#cb35-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-349"><a href="#cb35-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-350"><a href="#cb35-350" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, mydata)</span>
<span id="cb35-351"><a href="#cb35-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-352"><a href="#cb35-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-353"><a href="#cb35-353" aria-hidden="true" tabindex="-1"></a>I valori prodotti dalla funzione <span class="in">`predict`</span> possono essere interpretati come misure di quanto un dato punto sia un outlier. <span class="in">`Anomaly Score`</span> (<span class="in">`type="anomaly_score"`</span> o predefinito): valori più alti indicano una maggiore probabilità che il punto sia un outlier.</span>
<span id="cb35-354"><a href="#cb35-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-357"><a href="#cb35-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-358"><a href="#cb35-358" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb35-359"><a href="#cb35-359" aria-hidden="true" tabindex="-1"></a>  scores, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">col=</span><span class="st">"navy"</span>,</span>
<span id="cb35-360"><a href="#cb35-360" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Outlier scores"</span>,</span>
<span id="cb35-361"><a href="#cb35-361" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">"Values"</span></span>
<span id="cb35-362"><a href="#cb35-362" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-363"><a href="#cb35-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-364"><a href="#cb35-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-365"><a href="#cb35-365" aria-hidden="true" tabindex="-1"></a>L'istogramma degli <span class="in">`Anomaly Score`</span> non rivela la presenza di outlier.</span>
<span id="cb35-366"><a href="#cb35-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-367"><a href="#cb35-367" aria-hidden="true" tabindex="-1"></a>Quando invece abbiamo evidenza che alcune osservazioni sono outliers, è importante procedere con attenzione per garantire che l'analisi successiva sia accurata. Di seguito viene descritto un metodo per identificare, segnare e gestire gli outliers nei dati.</span>
<span id="cb35-368"><a href="#cb35-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-369"><a href="#cb35-369" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Passaggi per Identificare e Gestire gli Outliers</span></span>
<span id="cb35-370"><a href="#cb35-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-371"><a href="#cb35-371" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Individuare gli Outliers**: Utilizzando l'algoritmo Isolation Forest, possiamo calcolare i punteggi di outlier per ogni osservazione. Supponiamo che i punteggi alti indichino una maggiore probabilità di essere un outlier. In questo esempio, utilizziamo una soglia di 0.6 per determinare quali osservazioni sono outliers.</span>
<span id="cb35-372"><a href="#cb35-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-373"><a href="#cb35-373" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Aggiungere una Colonna `outlier`**: Aggiungiamo una colonna al nostro dataset per indicare se un'osservazione è considerata un outlier (TRUE) o meno (FALSE).</span>
<span id="cb35-374"><a href="#cb35-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-375"><a href="#cb35-375" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Visualizzare le Osservazioni Outliers**: Filtriamo e visualizziamo le osservazioni che sono state classificate come outliers.</span>
<span id="cb35-376"><a href="#cb35-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-377"><a href="#cb35-377" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Gestire gli Outliers**: Abbiamo due opzioni principali per gestire gli outliers:</span>
<span id="cb35-378"><a href="#cb35-378" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Escludere le osservazioni che contengono outliers.</span>
<span id="cb35-379"><a href="#cb35-379" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sostituire le osservazioni outliers con valori mancanti (NA) e successivamente utilizzare una procedura di imputazione multipla per trattare i dati mancanti. Questa seconda opzione è generalmente preferibile, in quanto permette di mantenere tutte le informazioni disponibili nel dataset.</span>
<span id="cb35-380"><a href="#cb35-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-381"><a href="#cb35-381" aria-hidden="true" tabindex="-1"></a>Gestire correttamente gli outliers è cruciale per l'accuratezza delle analisi. Utilizzando una soglia per identificare gli outliers e scegliendo una delle due opzioni di gestione presentate, possiamo migliorare la qualità dei nostri dati e ottenere risultati più affidabili nelle nostre analisi. La procedura di imputazione multipla è spesso preferibile in quanto preserva l'informazione completa del dataset.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>